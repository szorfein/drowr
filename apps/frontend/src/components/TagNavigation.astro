---
import { getAllPosts } from "../lib/client";
import { ChipsFilter } from "@drowr/licid";

const data = await getAllPosts();
const allPosts = data.publication.posts.edges;

const tags = [...new Set(allPosts.flatMap((post) => post.node.tags))];
const currentPath = new URL(Astro.request.url).pathname;
const pathSegments = currentPath
  .split("/")
  .filter((segment) => segment.length > 0);
const currentTag = pathSegments[pathSegments.length - 1] || "";
console.log(currentTag);
---

<div class="mb-6 flex flex-row flex-wrap items-center justify-start gap-2">
  <ChipsFilter
    name="all"
    slug="/tags"
    isfocus={`${currentTag === "post" ? true : false}`}
  />
  {
    tags.map((t) => (
      <>
        <ChipsFilter name={t.name} slug={`/tag/${t.slug}`} />
      </>
    ))
  }
</div>
